(function(t){function e(e){for(var s,n,r=e[0],c=e[1],l=e[2],u=0,m=[];u<r.length;u++)n=r[u],o[n]&&m.push(o[n][0]),o[n]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);d&&d(e);while(m.length)m.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],s=!0,r=1;r<a.length;r++){var c=a[r];0!==o[c]&&(s=!1)}s&&(i.splice(e--,1),t=n(n.s=a[0]))}return t}var s={},o={app:0},i=[];function n(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=s,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(a,s,function(e){return t[e]}.bind(null,s));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var d=c;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var s=a("64a9"),o=a.n(s);o.a},"085a":function(t,e,a){},"2ade":function(t,e,a){"use strict";var s=a("cc56"),o=a.n(s);o.a},"314d":function(t,e,a){"use strict";var s=a("6539"),o=a.n(s);o.a},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var s=a("2b0e"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},i=[],n=(a("034f"),a("2877")),r={},c=Object(n["a"])(r,o,i,!1,null,null,null),l=c.exports,d=a("8c4f"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("div",{staticClass:"container"},[t._m(0),a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-one-quarter"},[a("router-link",{attrs:{to:"/stores/"}},[a("div",{staticClass:"box notification is-success"},[a("p",{staticClass:"title"},[t._v("Stores Dewar Management")]),a("p",{staticClass:"content"},[t._v("To handle dewars coming into or out of the facility")])])])],1),a("div",{staticClass:"column is-one-quarter"},[a("router-link",{attrs:{to:"/zone6/"}},[a("div",{staticClass:"box notification is-success"},[a("p",{staticClass:"title"},[t._v("Zone 6 Dewar Management")]),a("p",{staticClass:"content"},[t._v("To handle dewars to and from beamlines")])])])],1),a("div",{staticClass:"column is-one-quarter"},[a("router-link",{attrs:{to:"/zone4/"}},[a("div",{staticClass:"box notification is-success"},[a("p",{staticClass:"title"},[t._v("Zone 4 Dewar Management")]),a("p",{staticClass:"content"},[t._v("To handle dewars in the WES storage unit")])])])],1),a("div",{staticClass:"column is-one-quarter"},[a("router-link",{attrs:{to:"/ebic/"}},[a("div",{staticClass:"box notification is-success"},[a("p",{staticClass:"title"},[t._v("eBIC Dewar Management")]),a("p",{staticClass:"content"},[t._v("To handle dewars to and from eBIC")])])])],1)])]),t._m(1)])},m=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"hero"},[a("div",{staticClass:"hero-body has-text-centered"},[a("div",{staticClass:"container"},[a("h1",{staticClass:"title"},[t._v("\n                      ISPyB Logistics Applications\n                  ")]),a("h2",{staticClass:"subtitle"},[t._v("\n                      These applications help track dewars at specific locations in the facility.\n                  ")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("footer",{staticClass:"footer has-text-centered"},[t._v("For questions about these applications, please contact Scientific Software "),a("a",{attrs:{href:"mailto:scientificsoftware@diamond.ac.uk?Subject=ISPyBLogistics"}},[t._v("here")])])}],f={name:"home"},h=f,A=Object(n["a"])(h,u,m,!1,null,null,null),p=A.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"stores"},[a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-half solid-border"},[a("h2",{staticClass:"title has-text-centered"},[t._v("Scan Dewar and Barcode")]),a("form",[a("div",{staticClass:"field"},[a("label",[t._v("Location")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.location,expression:"location"}],ref:"location",staticClass:"input",attrs:{type:"text",placeholder:"Scan the location e.g. STORES-IN or STORES-OUT"},domProps:{value:t.location},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onLocationEnter(e)},input:function(e){e.target.composing||(t.location=e.target.value)}}})])]),a("div",{staticClass:"field"},[a("label",[t._v("Barcode")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.barcode,expression:"barcode"}],ref:"barcode",staticClass:"input",attrs:{type:"text",placeholder:"Scan the QR code / barcode from the dewar case"},domProps:{value:t.barcode},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onBarcodeEnter(e)},input:function(e){e.target.composing||(t.barcode=e.target.value)}}})])]),a("div",{directives:[{name:"show",rawName:"v-show",value:"STORES-IN"!=t.location.toUpperCase(),expression:"location.toUpperCase() != 'STORES-IN'"}],staticClass:"field"},[a("label",[t._v("Airway Bill")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.awb,expression:"awb"}],ref:"awb",staticClass:"input",attrs:{type:"text",placeholder:"Scan the DHL / FedEx Airway Bill"},domProps:{value:t.awb},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onAwbEnter(e)},input:function(e){e.target.composing||(t.awb=e.target.value)}}})])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("button",{staticClass:"button is-link is-fullwidth",attrs:{type:"submit"},on:{click:t.onSetLocation}},[t._v("Submit")])]),a("div",{staticClass:"column"},[a("button",{staticClass:"button is-info is-fullwidth",attrs:{type:"cancel"},on:{click:t.onClearLocationForm}},[t._v("Cancel")])])])])]),t._m(0)]),t.message?a("div",{staticClass:"columns"},[a("article",{staticClass:"column is-12 message",class:[t.isError?"is-danger":"is-info"]},[a("div",{staticClass:"message-body subtitle"},[t._v("\n                  "+t._s(t.message)+"\n                  ")])])]):t._e()]),a("div",{staticClass:"container-fluid"},[t._m(1),a("br"),a("table",{staticClass:"table is-bordered is-fullwidth is-striped"},[t._m(2),a("tbody",{staticClass:"center-table"},t._l(t.dewars,function(e,s){return a("tr",{key:s},[a("td",[t._v(t._s(e.date))]),a("td",[t._v(t._s(e.barcode.toUpperCase())+" "),e.sid?a("span",[a("a",{attrs:{href:"https://ispyb.diamond.ac.uk/shipments/sid/"+e.sid}},[t._v("â†—")])]):t._e()]),a("td",[t._v(t._s(e.inout.toUpperCase()))]),a("td",[t._v(t._s(e.destination))]),"STORES-OUT"===e.inout.toUpperCase()?a("td",[t.isDHL(e.awb)?a("a",{attrs:{href:"http://www.dhl.com/en/express/tracking.html?AWB="+e.awb}},[t._v(t._s(e.awb))]):t.isFedexDatabaseRecord(e.awb)?a("a",{attrs:{href:"http://www.fedex.com/apps/fedextrack/?trackingnumber="+e.awb}},[t._v(t._s(e.awb))]):a("span",[t._v(t._s(e.awb))])]):a("td")])}),0)])])])},b=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"column is-half solid-border"},[s("h2",{staticClass:"title has-text-centered"},[t._v("Locations")]),s("br"),s("nav",{staticClass:"level"},[s("div",{staticClass:"level-item has-text-centered"},[s("div",[s("img",{attrs:{width:"96",src:a("fc6f")}}),s("p",{staticClass:"subtitle"},[t._v("STORES-IN")])])]),s("div",{staticClass:"level-item has-text-centered"},[s("div",[s("img",{attrs:{width:"96",src:a("acb3")}}),s("p",{staticClass:"subtitle"},[t._v("STORES-OUT")])])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"has-text-centered"},[a("h1",{staticClass:"title"},[t._v("History")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"center-table"},[a("th",[t._v("Date/Time")]),a("th",[t._v("Barcode")]),a("th",[t._v("In or Out?")]),a("th",[t._v("Destination")]),a("th",[t._v("Airway Bill")])])}],C=(a("ac6a"),a("456d"),{name:"stores",data:function(){return{dewars:[],barcode:"",location:"",awb:"",message:"",isError:!1,isFormOK:!0,clearMessageInterval:3,refreshInterval:30}},mounted:function(){console.log("Vue App Instance Mounted"),this.$refs.location.focus();var t=window.localStorage.getItem("location");t&&(console.log("Setting location from local storage"),this.location=t,this.$refs.barcode.focus(),window.localStorage.removeItem("location")),this.getDewars(),setInterval(this.refresh,1e3*this.refreshInterval)},methods:{refresh:function(){console.log("Refresh - saving location in localStorage"),window.localStorage.setItem("location",this.location),window.location.reload()},getDewars:function(){var t=this;t.dewars=[],this.$http.get("/api/stores/dewars").then(function(e){console.log(e.data);var a=e.data,s=Object.keys(a);s.forEach(function(e){var s=a[e];t.dewars.push(s)})}).catch(function(){console.log("Error getting initial data"),t.message="Error retrieving initial data",t.isError=!0})},onSetLocation:function(t){console.log("onSetLocation"),t.preventDefault();var e=this,a=this.isValidLocation(this.location);if(this.barcode&&this.location&&a){var s=this.barcode,o=this.location,i="";"STORES-OUT"===o.toUpperCase()&&(i=this.awb,this.isFedex(i)&&(i=this.getFedexTrackingNumber(i)));var n=new FormData;n.append("barcode",s),n.append("location",o),n.append("awb",i),this.$http.post("/api/stores/dewars",n).then(function(t){console.log(t);var a=t.data;a["DEWARHISTORYID"]>0?e.message="Updated "+s+" to "+o:(e.message="Error - no dewar history id returned",e.isError=!0),e.getDewars()}).catch(function(t){console.log(t),e.message="Error updating "+s+" to "+o,e.isError=!0}),this.$refs.barcode.focus(),this.barcode="",this.awb=""}else this.message="Issue with form: ",this.isError=!0,""===this.barcode&&(this.message+=" no barcode provided..."),""===this.location?this.message+=" no location provided...":a||(this.message+=" location not valid for this application...")},onClearLocationForm:function(t){t.preventDefault(),this.barcode="",this.location="",this.awb="",this.$refs.location.focus()},clearMessages:function(){this.message="",this.isError=!1},isDHL:function(t){var e=/^[0-9]{10}$/,a=/^JJ?D[0-9]{18}$/;return!(!e.test(t)&&!a.test(t))},isFedex:function(t){var e=/^[0-9]{16}$/,a=/^[0-9]{34}$/;return!(!e.test(t)&&!a.test(t))},isFedexDatabaseRecord:function(t){var e=/^[0-9]{14}$/;return!!e.test(t)},getFedexTrackingNumber:function(t){var e=t;return 16===t.length?e="00"+t.slice(0,12):34===t.length?e=t.slice(-14):console.log("Error - invalid fedex tracking code provided"),e},isValidLocation:function(t){return"STORES-IN"===t.toUpperCase()||"STORES-OUT"===t.toUpperCase()},onLocationEnter:function(t){t.preventDefault(),this.$refs.barcode.focus()},onBarcodeEnter:function(t){t.preventDefault(),this.isValidLocation(this.barcode)?(this.location=this.barcode,this.barcode="",this.$refs.barcode.focus()):"STORES-IN"===this.location.toUpperCase()?this.onSetLocation(t):this.$refs.awb.focus()},onAwbEnter:function(t){t.preventDefault(),this.isValidLocation(this.awb)?(this.location=this.awb,this.awb="",this.$refs.barcode.focus()):this.barcode&&this.location&&this.onSetLocation(t)}}}),w=C,g=(a("d1fe"),Object(n["a"])(w,v,b,!1,null,null,null)),_=g.exports,M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column is-one-third solid-border"},[a("ScanDewar",{attrs:{allowed_locations:t.allowed_locations},on:{"dewars-updated":t.handleDewarUpdate}})],1),a("div",{staticClass:"column is-one-third solid-border"},[a("FindDewar")],1),a("div",{staticClass:"column is-one-third solid-border"},[a("DispatchDewars",{attrs:{rack_locations:t.rack_locations}})],1)]),a("MessagePanel"),"zone6"===t.zone?a("div",{staticClass:" solid-border columns is-multiline"},t._l(t.rack_locations,function(e,s){return a("div",{key:s,staticClass:"column is-3"},[a("div",{staticClass:"box has-background-white-ter",class:{"has-text-danger":e.needsLN2&&"dispatch-requested"!==e.status},on:{click:function(e){return t.onClearLocation(s)}}},[a("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(s)+": ")]),e.barcode?a("span",{staticClass:"content has-text-weight-bold"},[t._v(t._s(e.barcode))]):a("span",{staticClass:"content is-invisible"},[t._v("empty")]),a("div",{staticClass:"tags has-addons"},[e.arrivalDate?a("span",{staticClass:"tag is-info"},[t._v(t._s(e.arrivalDate.split(" ").slice(0,4).join(" ")))]):t._e(),e.facilityCode?a("span",{staticClass:"tag is-dark"},[t._v(t._s(e.facilityCode))]):t._e(),"dispatch-requested"==e.status?a("span",{staticClass:"tag is-warning"},[t._v(t._s(e.status))]):e.needsLN2?a("span",{staticClass:"tag is-danger"},[t._v("needs-refill")]):t._e()])])])}),0):"zone4"===t.zone?a("div",{staticClass:" solid-border columns is-multiline"},t._l(t.rack_locations,function(e,s){return a("div",{key:s,staticClass:"column is-2"},[a("div",{staticClass:"box has-background-white-ter",class:{"has-text-danger":e.needsLN2&&"dispatch-requested"!==e.status},on:{click:function(e){return t.onClearLocation(s)}}},[a("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(s)+": ")]),e.barcode?a("span",{staticClass:"content has-text-weight-bold"},[t._v(t._s(e.barcode))]):a("span",{staticClass:"content is-invisible"},[t._v("empty")]),a("div",{staticClass:"tags has-addons"},[e.arrivalDate?a("span",{staticClass:"tag is-info"},[t._v(t._s(e.arrivalDate.split(" ").slice(0,4).join(" ")))]):t._e(),e.facilityCode?a("span",{staticClass:"tag is-dark"},[t._v(t._s(e.facilityCode))]):t._e(),"dispatch-requested"==e.status?a("span",{staticClass:"tag is-warning"},[t._v(t._s(e.status))]):e.needsLN2?a("span",{staticClass:"tag is-danger"},[t._v("needs-refill")]):t._e()])])])}),0):"ebic"===t.zone?a("div",{staticClass:" solid-border columns is-multiline"},t._l(t.rack_locations,function(e,s){return a("div",{key:s,staticClass:"column is-3"},[a("div",{staticClass:"box has-background-white-ter",class:{"has-text-danger":e.needsLN2&&"dispatch-requested"!==e.status},on:{click:function(e){return t.onClearLocation(s)}}},[a("span",{staticClass:"has-text-weight-bold"},[t._v(t._s(s)+": ")]),e.barcode?a("span",{staticClass:"content has-text-weight-bold"},[t._v(t._s(e.barcode))]):a("span",{staticClass:"content is-invisible"},[t._v("empty")]),a("div",{staticClass:"tags has-addons"},[e.arrivalDate?a("span",{staticClass:"tag is-info"},[t._v(t._s(e.arrivalDate.split(" ").slice(0,4).join(" ")))]):t._e(),e.facilityCode?a("span",{staticClass:"tag is-dark"},[t._v(t._s(e.facilityCode))]):t._e(),"dispatch-requested"==e.status?a("span",{staticClass:"tag is-warning"},[t._v(t._s(e.status))]):e.needsLN2?a("span",{staticClass:"tag is-danger"},[t._v("needs-refill")]):t._e()])])])}),0):a("div",[a("p",[t._v("No known storage location")])]),a("ClearLocationDialog",{attrs:{isActive:t.isRemoveDialogActive,locationToRemove:t.locationToRemove,rack_locations:t.rack_locations},on:{"confirm-removal":t.onConfirmClear}})],1)},z=[],V=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("h2",{staticClass:"title has-text-centered"},[t._v("Scan Dewar and Rack")]),a("form",[a("div",{staticClass:"field"},[a("label",[t._v("Barcode or FacilityCode")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.barcode,expression:"barcode"}],ref:"barcode",staticClass:"input",attrs:{type:"text",placeholder:"Scan the long barcode from the dewar case"},domProps:{value:t.barcode},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onBarcodeEnter(e)},input:function(e){e.target.composing||(t.barcode=e.target.value)}}})])]),a("div",{staticClass:"field"},[a("label",[t._v("Location")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.location,expression:"location"}],ref:"location",staticClass:"input",attrs:{type:"text",placeholder:"Scan the location e.g. RACK-A1"},domProps:{value:t.location},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onLocationEnter(e)},input:function(e){e.target.composing||(t.location=e.target.value)}}})])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("button",{staticClass:"button is-link is-fullwidth",attrs:{type:"submit"},on:{click:t.onSetLocation}},[t._v("Submit")])]),a("div",{staticClass:"column"},[a("button",{staticClass:"button is-info is-fullwidth",attrs:{type:"cancel"},on:{click:t.onClearLocationForm}},[t._v("Cancel")])])])])])},y=[],D={name:"ScanDewar",props:{msg:String,allowed_locations:Array},data:function(){return{barcode:"",location:""}},mounted:function(){this.$refs.barcode.focus()},methods:{onClearLocationForm:function(){console.log("on Clear Location Form")},onBarcodeEnter:function(t){t.preventDefault(),this.$refs.location.focus()},onLocationEnter:function(t){t.preventDefault(),this.barcode&&this.onSetLocation(t)},onSetLocation:function(t){if(t.preventDefault(),this.barcode&&this.location){var e=this.allowed_locations.indexOf(this.location.toUpperCase());if(e<0){var a="Error - location "+this.location+" not allowed for this page",s=!0;return this.$store.dispatch("updateMessage",{text:a,isError:s}),this.location="",void this.playFail()}var o=new FormData;o.append("barcode",this.barcode),o.append("location",this.location);var i=this,n=this.barcode,r=this.location,c=this.$store.state.apiRoot+"dewars/locations";this.$http.post(c,o).then(function(t){var e=t.data,a="",s=!1;e["DEWARHISTORYID"]>0?(a="Updating "+n+" to "+r,i.playSuccess(),i.$emit("dewars-updated")):(a=e["reason"]?e["reason"]:"Error - no dewar history id returned",s=!0,i.playFail()),i.$store.dispatch("updateMessage",{text:a,isError:s})}).catch(function(){var t="Error updating "+n+" to "+r,e=!0;i.$store.dispatch("updateMessage",{text:t,isError:e}),i.playFail()}),this.barcode="",this.location="",this.$refs.barcode.focus()}else{var l="Issue with form: ";""===this.barcode&&(l+=" no barcode provided..."),""===this.location&&(l+=" no location provided..."),this.$store.dispatch("updateMessage",{text:l,isError:!1})}},playSuccess:function(){console.log("HAPPY BEEPS")},playFail:function(){console.log("SAD BEEPS")}}},k=D,Z=Object(n["a"])(k,V,y,!1,null,null,null),x=Z.exports,O=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("h2",{staticClass:"title has-text-centered"},[t._v("Find a Dewar")]),a("form",[a("div",{staticClass:"field"},[a("label",[t._v("BarCode or FacilityCode")]),a("div",{staticClass:"control"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.facilitycode,expression:"facilitycode"}],staticClass:"input",attrs:{type:"text",placeholder:"e.g. DLS-MX-####"},domProps:{value:t.facilitycode},on:{input:function(e){e.target.composing||(t.facilitycode=e.target.value)}}})])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("button",{staticClass:"button is-link is-fullwidth",attrs:{type:"submit"},on:{click:t.onFindDewar}},[t._v("Search")])]),a("div",{staticClass:"column"},[a("button",{staticClass:"button is-info is-fullwidth",attrs:{type:"submit"},on:{click:t.onClearFindForm}},[t._v("Cancel")])])]),t.searchResult?a("div",{staticClass:"field has-text-left"},[a("p",{staticClass:"subtitle"},[t._v("Location History")]),a("ul",{staticClass:"timeline"},t._l(t.searchResult.slice(0,5),function(e,s){return a("li",{key:s,staticClass:"timeline-container"},[a("div",{staticClass:"timeline-content"},[a("p",[t._v(t._s(e.location))]),a("p",{staticClass:"tag"},[t._v(t._s(e.arrivalDate))])])])}),0)]):t.searchResultError?a("div",{staticClass:"field has-text-left"},[a("p",{staticClass:"subtitle has-text-danger"},[t._v(t._s(t.searchResultError))])]):t._e()])])},E=[],q={name:"FindDewar",data:function(){return{searchResult:null,searchResultError:null,facilitycode:""}},watch:{searchResult:function(t){t&&setTimeout(this.clearMessages,1e4)}},methods:{onFindDewar:function(t){if(t.preventDefault(),console.log("Find Dewar"),""!==this.facilitycode){var e=this,a=this.facilitycode,s=this.$store.state.apiRoot+"dewars/find";this.$http.get(s,{params:{fc:a}}).then(function(t){var a=t.data,s=a["storageLocations"];s.forEach(function(t){t.location=t.location?t.location.toUpperCase():"none"}),e.searchResult=s}).catch(function(){e.searchResult=null,e.searchResultError="Dewar "+a+" not found"}).finally(function(){})}else this.message="No facility code provided"},onClearFindForm:function(t){t.preventDefault(),this.facilitycode=""},clearMessages:function(){this.searchResult=null,this.searchResultError=null}}},P=q,S=(a("2ade"),Object(n["a"])(P,O,E,!1,null,null,null)),T=S.exports,R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("transition",{attrs:{name:"fade",mode:"out-in"}},[t.show_dewars?a("section",{key:"1"},[a("h2",{staticClass:"title has-text-centered"},[t._v("Dewars that need refilling")]),a("ul",t._l(t.refill_dewars.slice(0,5),function(e,s){return a("li",{key:s},[a("p",{staticClass:"is-size-5 has-text-centered has-background-danger has-text-black"},[a("b",[t._v(t._s(e))])])])}),0),a("footer",{staticClass:"footer has-background-white-ter is-paddingless"},[a("div",{staticClass:"content has-text-centered"},[a("p",[t._v("(Scan dewars back into the same position after refilling)")])])])]):a("section",{key:"2"},[a("h2",{staticClass:"title has-text-centered"},[t._v("Dewars that need dispatching")]),a("ul",t._l(t.dispatch_dewars.slice(0,5),function(e,s){return a("li",{key:s},[a("p",{staticClass:"is-size-5 has-text-centered has-background-warning has-text-black"},[a("b",[t._v(t._s(e))])])])}),0),a("footer",{staticClass:"footer has-background-white-ter is-paddingless"},[a("div",{staticClass:"content has-text-centered"},[a("p",[t._v("(Dewars in need of dispatch - clear once removed from rack)")])])])])])],1)},L=[],j={name:"DispatchDewars",props:{rack_locations:Object},data:function(){return{show_dewars:!0}},computed:{refill_dewars:function(){var t=this,e=Object.keys(this.rack_locations).filter(function(e){return"dispatch-requested"!==t.rack_locations[e].status&&!0===t.rack_locations[e].needsLN2});return e},dispatch_dewars:function(){var t=this,e=Object.keys(this.rack_locations).filter(function(e){return"dispatch-requested"===t.rack_locations[e].status});return e}},methods:{swapDispatchDewarView:function(){this.show_dewars=!this.show_dewars}},mounted:function(){setInterval(this.swapDispatchDewarView,5e3)}},F=j,B=(a("314d"),Object(n["a"])(F,R,L,!1,null,null,null)),$=B.exports,G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.message?a("div",{staticClass:"columns"},[a("article",{staticClass:"column is-12 message",class:[t.isError?"is-danger":"is-info"]},[a("div",{staticClass:"message-body subtitle"},[t._v("\n      "+t._s(t.message)+"\n    ")])])]):t._e()},J=[],I={name:"ErrorMessage",computed:{message:function(){return this.$store.state.message.text},isError:function(){return this.$store.state.message.isError}}},N=I,W=Object(n["a"])(N,G,J,!1,null,null,null),Y=W.exports,U=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal",class:{"is-active":t.isActive}},[a("div",{staticClass:"modal-background"}),a("div",{staticClass:"modal-card"},[t._m(0),a("section",{staticClass:"modal-card-body"},[a("p",[t._v("Confirm removal of dewar from location "+t._s(t.locationToRemove)+"?")])]),a("footer",{staticClass:"modal-card-foot"},[a("button",{staticClass:"button is-success",on:{click:function(e){return t.onConfirmClear(!0)}}},[t._v("Confirm")]),a("button",{staticClass:"button",on:{click:function(e){return t.onConfirmClear(!1)}}},[t._v("Cancel")])])])])},H=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"modal-card-head"},[a("p",{staticClass:"modal-card-title"},[t._v("Confirm Clear")])])}],Q={name:"ClearLocationDialog",props:["isActive","locationToRemove","rack_locations"],methods:{onConfirmClear:function(t){if(!0===t){var e=this.rack_locations.hasOwnProperty(this.locationToRemove);if(e){var a=this,s=this.rack_locations[this.locationToRemove]["barcode"],o=this.$store.state.apiRoot+"dewars/locations";this.$http.delete(o,{params:{location:this.locationToRemove}}).then(function(t){console.log(t);var e="Dewar removed "+s+" from location "+a.locationToRemove;this.$store.dispatch("updateMessage",{text:e,isError:!1})}).catch(function(){var t="Error removing dewar "+s+" from location "+a.locationToRemove;a.$store.dispatch("updateMessage",{text:t,isError:!0})})}}this.$emit("confirm-removal",t)}}},X=Q,K=Object(n["a"])(X,U,H,!1,null,null,null),tt=K.exports,et={name:"DewarZone",props:["zone"],components:{FindDewar:T,ScanDewar:x,DispatchDewars:$,MessagePanel:Y,ClearLocationDialog:tt},data:function(){return{locationToRemove:null,isRemoveDialogActive:!1,beamlines:[],rack_locations:{},refresh:null,refreshInterval:6e4}},created:function(){console.log("Dewar Storage Zone Component Created");var t=this,e=this.$store.state.apiRoot+"beamlines/"+this.zone;this.$http.get(e).then(function(e){var a=e.data;t.beamlines=a}).catch(function(t){console.log("Error getting valid beamline locations "+t)})},computed:{allowed_locations:function(){return this.beamlines.concat(Object.keys(this.rack_locations))}},mounted:function(){this.getBarcodes()},methods:{handleDewarUpdate:function(){console.log("Dewar updated OK"),this.getBarcodes()},getBarcodes:function(){var t=this,e={};t.refresh&&clearTimeout(t.refresh);var a=this.$store.state.apiRoot+"dewars/locations/"+this.zone;this.$http.get(a).then(function(a){var s=a.data,o=Object.keys(s);o.forEach(function(t){var a=s[t][0],o=s[t][1],i=s[t][2],n=s[t][3],r=!1;if(""!==o){var c=(new Date).getTime()/1e3,l=Date.parse(o)/1e3,d=c-l;d>432e3&&(r=!0)}e[t]={barcode:a,arrivalDate:o,needsLN2:r,facilityCode:i,status:n}}),t.rack_locations=e}).catch(function(a){var s="",o=!0;if(404===a.response.status){s="Warning no dewars found in these locations";var i=Object.keys(a.response.data);console.log("Error but rack list = "+i),i.forEach(function(t){e[t]={barcode:"",arrivalDate:"",needsLN2:!1,facilityCode:"",status:""}}),t.rack_locations=e}else s="Error retrieving dewar location information from database";this.$store.commit("updateMessage",{text:s,isError:o})}),t.refresh=setTimeout(t.getBarcodes,t.refreshInterval)},onClearLocation:function(t){this.isRemoveDialogActive=!0,this.locationToRemove=t},onConfirmClear:function(t){t&&this.getBarcodes(),this.locationToRemove="",this.isRemoveDialogActive=!1}}},at=et,st=(a("80ad"),Object(n["a"])(at,M,z,!1,null,null,null)),ot=st.exports;s["a"].use(d["a"]);var it=new d["a"]({mode:"history",routes:[{path:"/",name:"home",component:p},{path:"/zone4",name:"Zone4",component:ot,props:{zone:"zone4"}},{path:"/zone6",name:"Zone6",component:ot,props:{zone:"zone6"}},{path:"/stores",name:"Stores",component:_},{path:"/ebic",name:"EBIC",component:ot,props:{zone:"ebic"}}]}),nt=a("2f62");s["a"].use(nt["a"]);var rt=new nt["a"].Store({timeoutId:null,state:{message:{text:"",isError:!1},apiRoot:"/api/",location:""},mutations:{setMessage:function(t,e){t.message.text=e.text,t.message.isError=e.isError},setApiRoot:function(t,e){console.log("Setting API ROOT to "+e),t.apiRoot=e}},actions:{updateMessage:function(t,e){this.timeoutId&&clearTimeout(this.timeoutId),t.commit("setMessage",e);var a=t;this.timeoutId=setTimeout(function(){a.commit("setMessage",{text:"",isError:!1})},3e3)}}}),ct=(a("92c6"),a("bc3a")),lt=a.n(ct);s["a"].config.productionTip=!1,s["a"].prototype.$http=lt.a,new s["a"]({router:it,store:rt,render:function(t){return t(l)}}).$mount("#app")},"64a9":function(t,e,a){},6539:function(t,e,a){},"80ad":function(t,e,a){"use strict";var s=a("085a"),o=a.n(s);o.a},9169:function(t,e,a){},acb3:function(t,e){t.exports="data:image/gif;base64,R0lGODlhQABAAPcAAAAAAAAAMwAAZgAAmQAAzAAA/wArAAArMwArZgArmQArzAAr/wBVAABVMwBVZgBVmQBVzABV/wCAAACAMwCAZgCAmQCAzACA/wCqAACqMwCqZgCqmQCqzACq/wDVAADVMwDVZgDVmQDVzADV/wD/AAD/MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMrADMrMzMrZjMrmTMrzDMr/zNVADNVMzNVZjNVmTNVzDNV/zOAADOAMzOAZjOAmTOAzDOA/zOqADOqMzOqZjOqmTOqzDOq/zPVADPVMzPVZjPVmTPVzDPV/zP/ADP/MzP/ZjP/mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YrAGYrM2YrZmYrmWYrzGYr/2ZVAGZVM2ZVZmZVmWZVzGZV/2aAAGaAM2aAZmaAmWaAzGaA/2aqAGaqM2aqZmaqmWaqzGaq/2bVAGbVM2bVZmbVmWbVzGbV/2b/AGb/M2b/Zmb/mWb/zGb//5kAAJkAM5kAZpkAmZkAzJkA/5krAJkrM5krZpkrmZkrzJkr/5lVAJlVM5lVZplVmZlVzJlV/5mAAJmAM5mAZpmAmZmAzJmA/5mqAJmqM5mqZpmqmZmqzJmq/5nVAJnVM5nVZpnVmZnVzJnV/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwAM8wAZswAmcwAzMwA/8wrAMwrM8wrZswrmcwrzMwr/8xVAMxVM8xVZsxVmcxVzMxV/8yAAMyAM8yAZsyAmcyAzMyA/8yqAMyqM8yqZsyqmcyqzMyq/8zVAMzVM8zVZszVmczVzMzV/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8Amf8AzP8A//8rAP8rM/8rZv8rmf8rzP8r//9VAP9VM/9VZv9Vmf9VzP9V//+AAP+AM/+AZv+Amf+AzP+A//+qAP+qM/+qZv+qmf+qzP+q///VAP/VM//VZv/Vmf/VzP/V////AP//M///Zv//mf//zP///wAAAAAAAAAAAAAAACH5BAEAAPwALAAAAABAAEAAAAj/AAEIBLCv4L6BBA0iNHhwIMOFCh1GFPhQYkGIFy02pDgxYUaOHz1uFIlxZEWQJjueJKmxpMuWMFG+lBmTJU2EOHGuZMiz58icKFcCHWpTpE+eRDUKTapT5VGfTI12jDpT6tOfQI8O1ZrVac+tU7uG5JpzJ1SxWMt6RYq25NKbRM1+bas0LFywIaviTTk36Nqob5uOPet3cF66SeWyLcw3rWDHVclabbz3at+iljMvnpw5subPbj9TriuaMGfLnktfDX2ZtWPFVElvdr1XL9POaAPDjn36MOPaNQGrXn3btOThxBMbX47cdOW1ipsHpi2b9+PodotaF35Zsu3tcZnPug4OPnx35+SV+6aqW/zx7NxfuxdfXnt12bvBtz+f/PHz/vltt59mqUFW3HqlFVjfgLjBNd2BjTVonoF31ZQghPEBx5h3iE2oYW/jqbVegQ+KOJqJJU5mXYDUqReih+mpCGGKCuYGH4b3uchhhSa2OOGO9vWY44/o8ejfkP+9SOOQzX244nygdfgkf6o5ydt7w1m5IXRFsvcXfly2duWXWxr21IJkgujakkIaWd+bcMYp55x01mnnnQMFBAA7"},cc56:function(t,e,a){},d1fe:function(t,e,a){"use strict";var s=a("9169"),o=a.n(s);o.a},fc6f:function(t,e){t.exports="data:image/gif;base64,R0lGODlhOAA4APcAAAAAAAAAMwAAZgAAmQAAzAAA/wArAAArMwArZgArmQArzAAr/wBVAABVMwBVZgBVmQBVzABV/wCAAACAMwCAZgCAmQCAzACA/wCqAACqMwCqZgCqmQCqzACq/wDVAADVMwDVZgDVmQDVzADV/wD/AAD/MwD/ZgD/mQD/zAD//zMAADMAMzMAZjMAmTMAzDMA/zMrADMrMzMrZjMrmTMrzDMr/zNVADNVMzNVZjNVmTNVzDNV/zOAADOAMzOAZjOAmTOAzDOA/zOqADOqMzOqZjOqmTOqzDOq/zPVADPVMzPVZjPVmTPVzDPV/zP/ADP/MzP/ZjP/mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YrAGYrM2YrZmYrmWYrzGYr/2ZVAGZVM2ZVZmZVmWZVzGZV/2aAAGaAM2aAZmaAmWaAzGaA/2aqAGaqM2aqZmaqmWaqzGaq/2bVAGbVM2bVZmbVmWbVzGbV/2b/AGb/M2b/Zmb/mWb/zGb//5kAAJkAM5kAZpkAmZkAzJkA/5krAJkrM5krZpkrmZkrzJkr/5lVAJlVM5lVZplVmZlVzJlV/5mAAJmAM5mAZpmAmZmAzJmA/5mqAJmqM5mqZpmqmZmqzJmq/5nVAJnVM5nVZpnVmZnVzJnV/5n/AJn/M5n/Zpn/mZn/zJn//8wAAMwAM8wAZswAmcwAzMwA/8wrAMwrM8wrZswrmcwrzMwr/8xVAMxVM8xVZsxVmcxVzMxV/8yAAMyAM8yAZsyAmcyAzMyA/8yqAMyqM8yqZsyqmcyqzMyq/8zVAMzVM8zVZszVmczVzMzV/8z/AMz/M8z/Zsz/mcz/zMz///8AAP8AM/8AZv8Amf8AzP8A//8rAP8rM/8rZv8rmf8rzP8r//9VAP9VM/9VZv9Vmf9VzP9V//+AAP+AM/+AZv+Amf+AzP+A//+qAP+qM/+qZv+qmf+qzP+q///VAP/VM//VZv/Vmf/VzP/V////AP//M///Zv//mf//zP///wAAAAAAAAAAAAAAACH5BAEAAPwALAAAAAA4ADgAAAj/AAEIBLCv4L6BBA0iNHhwIMOFCh1GFPhQYkGIFy02pDgxYUaOHz1uFIlxZEWQJjueJKmxpMuWMFG+REiT5kqGOHOmDFmzZ8+bOoPO9El0aFChMYsqBXoU51CfSGsybarTaNWfKqlGZYlypVWtOb86xRoS7FWZZEdCpfpUaVupbJO6fWszLtq5dXmm3ep1qdmxXc8Snfp351G3hP+W3Lq2bOGsTRFDPqyRceWOjSkHDrsXc2fOmwHnFZ2Zr93RfeE+Brv49GqzrSNffi24cGzaom1/zi0YL16tt30LF2ka9HDJskMfX+7XuNjUwy3fJe75uHSu1PVa7530+tTbwJd/V5/NWvxk8KeFjw8dfrvxxM7Jlz5PHrr32pPvx1fePb385pphR5d6rlUnoHnJHTgdc+0p6GBmdOlW1HoOSjgYfQvWx51qhkWoGIDMhSjiiCSWaOKJKPoUEAA7"}});
//# sourceMappingURL=app.6d1e5806.js.map